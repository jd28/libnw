<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>kernel &mdash; rollNW  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="model" href="model.html" />
    <link rel="prev" title="i18n" href="i18n.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> rollNW
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gs/building.html">building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gs/using.html">using</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">structure</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="formats.html">formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">i18n</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">kernel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#services">Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#config">Config</a></li>
<li class="toctree-l3"><a class="reference internal" href="#objects">Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resources">Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rules">Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#strings">Strings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.html">model</a></li>
<li class="toctree-l1"><a class="reference internal" href="rules.html">rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="script.html">script</a></li>
<li class="toctree-l1"><a class="reference internal" href="serialization.html">serialization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">c++ api</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/classlist.html">classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/definelist.html">defines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/enumlist.html">enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/functionlist.html">functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/typedeflist.html">typedefs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">python api</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_python/classlist.html">classes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">gff schemas</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/are.html">are</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/dlg.html">dlg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/fac.html">fac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/gic.html">gic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/git.html">git</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/ifo.html">ifo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/itp.html">itp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/jrl.html">jrl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/utc.html">utc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/utd.html">utd</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/ute.html">ute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/uti.html">uti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/utm.html">utm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/utp.html">utp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/uts.html">uts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/utt.html">utt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/utw.html">utw</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gff_schema/vartable.html">vartable</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">rollNW</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>kernel</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/structure/kernel.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="kernel">
<h1>kernel<a class="headerlink" href="#kernel" title="Permalink to this headline"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">kernel</span></code> module provides submodules for handling global resources
and services. It’s designed around some explicit goals:</p>
<ul class="simple">
<li><p>Every service should be easily overrideable to allow for <a class="reference external" href="http://sevangelatos.com/john-carmack-on-parallel-implementations/">parallel
implementation</a>.</p></li>
<li><p>Every service should be decoupled from the kernel itself.</p></li>
<li><p>Any function or object that can modify global state must be contained
in this module for easy search/grepability.</p></li>
</ul>
<div class="section" id="services">
<h2>Services<a class="headerlink" href="#services" title="Permalink to this headline"></a></h2>
<div class="section" id="config">
<h3>Config<a class="headerlink" href="#config" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Config</span></code> service provides access to installation info, path
aliases, Ini and Toml settings.</p>
<p><strong>Example</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">options</span><span class="p">().</span><span class="n">version</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nw</span><span class="o">::</span><span class="n">GameVersion</span><span class="o">::</span><span class="n">vEE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">REQUIRE_FALSE</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="n">settings_tml</span><span class="p">().</span><span class="n">empty</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="n">REQUIRE</span><span class="p">(</span><span class="o">*</span><span class="n">config</span><span class="p">.</span><span class="n">settings_tml</span><span class="p">()[</span><span class="s">&quot;game&quot;</span><span class="p">][</span><span class="s">&quot;gore&quot;</span><span class="p">].</span><span class="n">as</span><span class="o">&lt;</span><span class="kt">int64_t</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="objects">
<h3>Objects<a class="headerlink" href="#objects" title="Permalink to this headline"></a></h3>
<p>rollNW is all about live objects and <em>not</em> serialized file formats.</p>
<p><strong>Definitions</strong></p>
<dl class="simple">
<dt><code class="xref cpp cpp-enum docutils literal notranslate"><span class="pre">ObjectID</span></code></dt><dd><p>Unlike NWN an ObjectID does not provide a one-to-one mapping to an object.  Rather,
it’s an index into a structure containing objects.</p>
</dd>
<dt><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">ObjectHandle</span></code></dt><dd><p>An object handle maps to a specific object it consists of an ObjectID, the objects type,
and an unsigned 16 bit integer indicating the object’s version.  To be valid, an object
handle must match what is in the object array.</p>
</dd>
<dt><code class="xref cpp cpp-struct docutils literal notranslate"><span class="pre">ObjectBase</span></code></dt><dd><p>The base class of all objects</p>
</dd>
</dl>
<p><strong>Example</strong></p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-ZnJvbSByb2xsbncgaW1wb3J0IENyZWF0dXJl" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-ZnJvbSByb2xsbncgaW1wb3J0IENyZWF0dXJl" name="ZnJvbSByb2xsbncgaW1wb3J0IENyZWF0dXJl" role="tab" tabindex="0">from rollnw import Creature</button><button aria-controls="panel-0-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button></div><div aria-labelledby="tab-0-ZnJvbSByb2xsbncgaW1wb3J0IENyZWF0dXJl" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-ZnJvbSByb2xsbncgaW1wb3J0IENyZWF0dXJl" name="ZnJvbSByb2xsbncgaW1wb3J0IENyZWF0dXJl" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The file can also be rollnw JSON format, it doesn&#39;t matter.</span>
<span class="n">cre</span> <span class="o">=</span> <span class="n">Creature</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;a/path/to/nw_chicken.utc&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">cre</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">on_attacked</span> <span class="o">==</span> <span class="s2">&quot;nw_c2_default5&quot;</span><span class="p">:</span>
   <span class="n">cre</span><span class="o">.</span><span class="n">scripts</span><span class="o">.</span><span class="n">on_attacked</span> <span class="o">=</span> <span class="s2">&quot;nw_shakenbake&quot;</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Qysr" name="Qysr" role="tabpanel" tabindex="0"><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Loading an object into the system directly from the file system.</span>
<span class="k">auto</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nw</span><span class="o">::</span><span class="n">kernel</span><span class="o">::</span><span class="n">objects</span><span class="p">().</span><span class="n">load</span><span class="o">&lt;</span><span class="n">nw</span><span class="o">::</span><span class="n">Creature</span><span class="o">&gt;</span><span class="p">(</span><span class="n">fs</span><span class="o">::</span><span class="n">path</span><span class="p">(</span><span class="s">&quot;a/path/to/nw_chicken.utc&quot;</span><span class="p">));</span><span class="w"></span>
<span class="k">if</span><span class="p">(</span><span class="n">obj</span><span class="o">-&gt;</span><span class="n">scripts</span><span class="p">.</span><span class="n">on_attacked</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;nw_c2_default5&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">obj</span><span class="o">-&gt;</span><span class="n">scripts</span><span class="p">.</span><span class="n">on_attacked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;nw_shakenbake&quot;</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div></div>
</div>
<hr class="docutils" />
<div class="section" id="resources">
<h3>Resources<a class="headerlink" href="#resources" title="Permalink to this headline"></a></h3>
<p>The resource services provides access the file system and resources stored in NWN container files.
The main goals mostly satisfied: the ability to read all NWN(:EE) containers. The ability to
add new container types is limited in utility due to <a class="reference external" href="https://github.com/nwnxee/unified">NWNX:EE</a>’s
lack of a ResMan plugin, even so the ability to load files from a Zip file is included.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 14%" />
<col style="width: 29%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Read</p></th>
<th class="head"><p>Write</p></th>
<th class="head"><p>In Situ
Modifications</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Key/Bif</p></td>
<td><p>Yes</p></td>
<td><p>Never</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p>ERF</p></td>
<td><p>Yes</p></td>
<td><p>Maybe</p></td>
<td><p>Maybe</p></td>
</tr>
<tr class="row-even"><td><p>NWSync</p></td>
<td><p>Yes</p></td>
<td><p>Never</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-odd"><td><p>NWSync Server
Directory</p></td>
<td><p>Not Yet</p></td>
<td><p>Never</p></td>
<td><p>Never</p></td>
</tr>
<tr class="row-even"><td><p>Directories</p></td>
<td><p>Yes</p></td>
<td><p>Yes (file format
dependant)</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td><p>Zip</p></td>
<td><p>Yes</p></td>
<td><p>Maybe</p></td>
<td><p>Maybe</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="rules">
<h3>Rules<a class="headerlink" href="#rules" title="Permalink to this headline"></a></h3>
<p>See <a class="reference external" href="https://jd28.github.io/rollnw/structure/rules.html">rules</a> for the module
supporting this service.</p>
</div>
<hr class="docutils" />
<div class="section" id="strings">
<h3>Strings<a class="headerlink" href="#strings" title="Permalink to this headline"></a></h3>
<p>Provides access to dialog/custom TLKs and localized strings. It also provides a
mechanism for interning commonly used strings.</p>
<p>See <a class="reference external" href="https://jd28.github.io/rollnw/structure/i18n.html">i18n</a> for the module
supporting this service.</p>
<p><strong>Example</strong></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nw</span><span class="o">::</span><span class="n">kernel</span><span class="o">::</span><span class="n">strings</span><span class="p">().</span><span class="n">intern</span><span class="p">(</span><span class="s">&quot;This is a Test&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;This is a Test&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="c1">// This will occur</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="i18n.html" class="btn btn-neutral float-left" title="i18n" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model.html" class="btn btn-neutral float-right" title="model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>